{% extends "base_admin.html" %}
{% load humanize %}
{% block content %}
<h3>Danh sách đơn hàng</h3>

<form method="get" class="mb-3">
  <input type="text" name="search" value="{{ search_query }}" placeholder="Tìm kiếm theo số điện thoại"
    class="form-control" />
  <button type="submit" class="btn btn-primary mt-2">Tìm kiếm</button>
  <a href="{% url 'custom_admin:order_list' %}" class="btn btn-secondary mt-2">Đặt lại</a>
</form>

<div style="max-height: 500px; overflow-y: auto; border: 1px solid #dee2e6; border-radius: 5px;">
  <table class="table table-bordered table-hover mb-0">
    <thead class="table-light">
    <tr>
      <th>ID</th>
      <th>Khách hàng</th>
      <th>Ngày tạo</th>
      <th>Tổng tiền</th>
      <th>Số điện thoại</th>
      <th>Địa chỉ</th>
      <th>Trạng thái</th>
      <th>Hành động</th>
    </tr>
  </thead>
  <tbody>
    {% for order in orders %}
    <tr>
      <td>#{{ order.id }}</td>
      <td>{{ order.user.username }}</td>
      <td>{{ order.create_date }}</td>
      <td>{{ order.total_amount|intcomma }} VND</td>
      <td>{{ order.phone }}</td>
      <td>{{ order.address }}</td>
      <td>
        {% if order.status == 0 %}🕒 Chưa thanh toán{% else %}✅ Đã thanh toán{% endif %}
      </td>
      <td>
        <a href="{% url 'custom_admin:order_edit' order.id %}" class="btn btn-sm btn-warning">Sửa</a>
        <a href="{% url 'custom_admin:order_delete' order.id %}" class="btn btn-sm btn-danger"
          onclick="return confirm('Bạn có chắc muốn xoá đơn hàng này?')">Xoá</a>
      </td>
    </tr>
    {% empty %}
    <tr>
      <td colspan="6">Không có đơn hàng nào.</td>
    </tr>
    {% endfor %}
  </tbody>
</table>
</div>
{% endblock %}