<!DOCTYPE html>
<html lang="en">

<head>
	{% load static %}
	{% load custom_filter %}
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta name="description" content="">
	<meta name="author" content="">
	<title>{% block title %}

		{% endblock title %}|MOBILE-STORE</title>
	<link href="{% static 'css/bootstrap.min.css' %}" rel="stylesheet">
	<link href="{% static 'css/font-awesome.min.css' %}" rel="stylesheet">
	<link href="{% static 'css/prettyPhoto.css' %}" rel="stylesheet">
	<link href="{% static 'css/price-range.css' %}" rel="stylesheet">
	<link href="{% static 'css/animate.css' %}" rel="stylesheet">
	<link href="{% static 'css/main.css' %}" rel="stylesheet">
	<link href="{% static 'css/responsive.css' %}" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.9.1/font/bootstrap-icons.css">
	<link rel="shortcut icon" href="{% static 'images/ico/favicon.ico' %}">
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" />


</head><!--/head-->

<style>
	.product {
		border-style: none;


	}

	#alert-add-product {
		background-color: lightgray;
		color: orange;
		width: 500px;
		position: fixed;
		z-index: 1000;
		top: 30%;
		left: 35%;
		display: none;
	}

	.pricing {
		border: 2px;
		padding: 15px;
		background-color: orange;
		color: white;
		height: 100px;
		width: 100px;
		border-radius: 50%;
	}

	#main div {
		border: 1px solid black;
		display: flex;
		align-items: center;
	}

	.header-row {
		display: flex;
		align-items: center;
		justify-content: space-between;
		gap: 20px;
		padding: 10px 0;
	}

	.logo img {
		height: 80px;
		width: auto;
	}

	.search-box {
		flex-grow: 1;
		display: flex;
		justify-content: center;
	}

	.search-form {
		display: flex;
		border: 1px solid #ccc;
		border-radius: 20px;
		overflow: hidden;
		max-width: 350px;
		width: 100%;
	}

	.search-form input[type="text"] {
		border: none;
		padding: 10px 15px;
		flex-grow: 1;
		outline: none;
		font-size: 14px;
	}

	.search-form button {
		background-color: #fe980f;
		border: none;
		padding: 0 15px;
		color: white;
		cursor: pointer;
		font-size: 16px;
	}

	.shop-menu ul {
		display: flex;
		gap: 15px;
		align-items: center;
		list-style: none;
		margin: 0;
		padding: 0;
	}

	.shop-menu li a {
		color: #333;
		font-weight: bold;
		text-decoration: none;
	}

	.shop-menu li a:hover {
		color: #fe980f;
	}

	html,
	body {
		height: 100%;
		margin: 0;
	}

	.wrapper {
		display: flex;
		flex-direction: column;
		min-height: 100vh;
	}

	footer {
		margin-top: auto;
		/* ƒê·∫©y footer xu·ªëng d∆∞·ªõi c√πng */
	}
</style>

<body>

	<div class="wrapper">
		<header id="header">
			<div class="header-middle">
				<div class="container">
					<div class="header-row">
						<div class="logo">
							<a href="{% url 'index' %}">
								<img src="{% static 'images/home/logo.jpg' %}" alt="Logo" />
							</a>
						</div>

						<div class="shop-menu">
							<ul>
								{% if user.is_authenticated %}
								{% if request.resolver_match.url_name == 'index' %}
								<div class="search-box">
									<form method="GET" action="{% url 'index' %}" class="search-form">
										<input type="text" name="q"
											placeholder="T√¨m theo t√™n s·∫£n ph·∫©m ho·∫∑c nh√† cung c·∫•p..."
											value="{{ request.GET.q }}">
										<button type="submit"><i class="fa fa-search"></i></button>
									</form>
								</div>
								{% endif %}

								<li>
									<a href="{% url 'account_info' %}">
										<i class="fa fa-user"></i> Xin ch√†o <b>{{ user.username }}</b>
									</a>
								</li>

								{% if user.is_staff %}
								<li>
									<a href="{% url 'custom_admin:dashboard' %}">
										<i class="fa fa-cogs"></i> Qu·∫£n tr·ªã
									</a>
								</li>
								{% endif %}

								<li>
									<a href="{% url 'logout_user' %}">
										<i class="fa fa-lock"></i> ƒêƒÉng xu·∫•t
									</a>
								</li>
								{% else %}
								<li>
									<a href="{% url 'login_user' %}">
										<i class="fa fa-lock"></i> ƒêƒÉng Nh·∫≠p
									</a>
								</li>
								{% endif %}

								<li>
									<a href="{% url 'show_cart' %}">
										<i class="fa fa-shopping-cart"></i> Gi·ªè h√†ng
										<sup class="badge">{{ user|count_product_in_card }}</sup>
									</a>
								</li>
							</ul>
						</div>
					</div>
				</div>
			</div>
		</header>


		{% block content %}

		{% endblock content %}

		<footer id="footer"><!--Footer-->

			<div class="footer-widget">
				<div class="container">
					<div class="row">
						<div class="col-sm-2">
							<div class="single-widget">
								<h2>D·ªãch v·ª•</h2>
								<ul class="nav nav-pills nav-stacked">
									<li><a href="#">Tr·ª£ gi√∫p tr·ª±c tuy·∫øn</a></li>
									<li><a href="#">Li√™n h·ªá v·ªõi ch√∫ng t√¥i</a></li>
									<li><a href="#">Tr·∫°ng th√°i ƒë∆°n h√†ng</a></li>
									<li><a href="#">Thay ƒë·ªïi v·ªã tr√≠</a></li>
									<li><a href="#">C√¢u h·ªèi th∆∞·ªùng g·∫∑p</a></li>
								</ul>
							</div>
						</div>

						<div class="col-sm-2">
							<div class="single-widget">
								<h2>Ch√≠nh s√°ch</h2>
								<ul class="nav nav-pills nav-stacked">
									<li><a href="#">ƒêi·ªÅu kho·∫£n s·ª≠ d·ª•ng</a></li>
									<li><a href="#">Ch√≠nh s√°ch b·∫£o m·∫≠t</a></li>
									<li><a href="#">Ch√≠nh s√°ch ho√†n ti·ªÅn</a></li>
									<li><a href="#">H·ªá th·ªëng thanh to√°n</a></li>
									<li><a href="#">H·ªá th·ªëng v√©</a></li>
								</ul>
							</div>
						</div>
						<div class="col-sm-2">
							<div class="single-widget">
								<h2>Gi·ªõi thi·ªáu v·ªÅ Shopper</h2>
								<ul class="nav nav-pills nav-stacked">
									<li><a href="#">Th√¥ng tin c√¥ng ty</a></li>
									<li><a href="#">Tuy·ªÉn d·ª•ng</a></li>
									<li><a href="#">V·ªã tr√≠ c·ª≠a h√†ng</a></li>
									<li><a href="#">Ch∆∞∆°ng tr√¨nh li√™n k·∫øt</a></li>
									<li><a href="#">B·∫£n quy·ªÅn</a></li>
								</ul>
							</div>
						</div>
						<div class="col-sm-3 col-sm-offset-1">
							<div class="single-widget">
								<h2>Gi·ªõi thi·ªáu</h2>
								<form action="#" class="searchform">
									<input type="text" placeholder="ƒê·ªãa ch·ªâ email c·ªßa b·∫°n" />
									<button type="submit" class="btn btn-default"><i
											class="fa fa-arrow-circle-o-right">G·ª≠i</i></button>
									<p>Nh·∫≠n th√¥ng tin c·∫≠p nh·∫≠t m·ªõi nh·∫•t t·ª´ ‚Äã‚Äã<br />trang web c·ªßa ch√∫ng t√¥i v√† t·ª± c·∫≠p
										nh·∫≠t...
									</p>
								</form>
							</div>
						</div>

					</div>
				</div>
			</div>

			<!-- Chatbot Nh√∫ng -->
			<!-- üåê Chatbot Ti·∫øng Vi·ªát -->
			<style>
				#chatbot-button {
					position: fixed;
					bottom: 20px;
					right: 20px;
					background-color: #0066ff;
					color: white;
					border: none;
					border-radius: 50%;
					width: 60px;
					height: 60px;
					font-size: 28px;
					cursor: pointer;
					box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
					z-index: 9999;
				}

				#chatbot-box {
					display: none;
					position: fixed;
					bottom: 90px;
					right: 20px;
					width: 360px;
					height: 500px;
					background: white;
					border: 1px solid #ccc;
					border-radius: 16px;
					box-shadow: 0 6px 16px rgba(0, 0, 0, 0.2);
					z-index: 9999;
					display: flex;
					flex-direction: column;
				}

				#chatbot-box.expanded {
					width: 90vw !important;
					height: 90vh !important;
					bottom: 5vh !important;
					right: 5vw !important;
				}

				#chatbot-header {
					background: #0066ff;
					color: white;
					padding: 12px;
					font-weight: bold;
					text-align: center;
					font-size: 16px;
					position: relative;
				}

				#chatbot-expand,
				#chatbot-close {
					position: absolute;
					top: 8px;
					background: transparent;
					border: none;
					color: white;
					font-size: 18px;
					cursor: pointer;
				}

				#chatbot-expand {
					right: 36px;
				}

				#chatbot-close {
					right: 8px;
				}

				#chatbot-messages {
					padding: 12px;
					flex: 1;
					overflow-y: auto;
					font-size: 14px;
					background: #f9f9f9;
				}

				#chatbot-input {
					display: flex;
					border-top: 1px solid #ddd;
				}

				#chatbot-input input {
					flex: 1;
					border: none;
					padding: 12px;
					font-size: 14px;
				}

				#chatbot-input button {
					background: #0066ff;
					color: white;
					border: none;
					padding: 12px 16px;
					cursor: pointer;
					font-size: 14px;
				}

				.chatbot-msg {
					margin: 6px 0;
					max-width: 80%;
					padding: 8px 12px;
					border-radius: 16px;
					line-height: 1.4;
				}

				.user {
					background: #DCF8C6;
					align-self: flex-end;
					text-align: right;
				}

				.bot {
					background: #e6ecff;
					align-self: flex-start;
					text-align: left;
				}
			</style>

			<!-- Chatbox -->
			<div id="chatbot-box">
				<div id="chatbot-header">
					ü§ñ Tr·ª£ l√Ω ·∫£o
					<button id="chatbot-expand" onclick="toggleExpand()">‚õ∂</button>
					<button id="chatbot-close" onclick="toggleChat(false)">‚ùå</button>
				</div>
				<div id="chatbot-messages">
					<div class="chatbot-msg bot">Ch√†o b·∫°n! T√¥i c√≥ th·ªÉ gi√∫p g√¨ h√¥m nay?</div>
				</div>
				<div id="chatbot-input">
					<input type="text" id="chatbot-text" placeholder="Nh·∫≠p c√¢u h·ªèi..." />
					<button onclick="sendChat()">G·ª≠i</button>
				</div>
			</div>

			<!-- N√∫t tr√≤n m·ªü chat -->
			<button id="chatbot-button" onclick="toggleChat(true)">üí¨</button>

			<!-- Script -->
			<script>
				function toggleChat(open) {
					const box = document.getElementById("chatbot-box");
					const btn = document.getElementById("chatbot-button");
					if (open) {
						box.style.display = "flex";
						btn.style.display = "none";
					} else {
						box.style.display = "none";
						btn.style.display = "block";
					}
				}
				function toggleExpand() {
					const box = document.getElementById("chatbot-box");
					box.classList.toggle("expanded");
				}
				function sendChat() {
					const textEl = document.getElementById("chatbot-text");
					const text = textEl.value.trim();
					if (!text) return;
					const msgBox = document.getElementById("chatbot-messages");
					msgBox.innerHTML += '<div class="chatbot-msg user">' + text + '</div>';
					textEl.value = "";
					setTimeout(function () {
						const reply = getSmartReply(text);
						msgBox.innerHTML += '<div class="chatbot-msg bot">' + reply + '</div>';
						msgBox.scrollTop = msgBox.scrollHeight;
					}, 500);
				}
				function getSmartReply(msg) {
					msg = msg.toLowerCase();
					if (msg.match(/(ch√†o|hello|hi)/)) return "Ch√†o b·∫°n! T√¥i c√≥ th·ªÉ gi√∫p g√¨?";
					if (msg.match(/(gi·ªù m·ªü c·ª≠a|gio mo cua|thoi gian mo cua|mo cua)/)) return "Ch√∫ng t√¥i m·ªü c·ª≠a t·ª´ 8h ƒë·∫øn 17h.";
					if (msg.match(/(s·∫£n ph·∫©m|san pham|ban co san pham gi)/)) return "Ch√∫ng t√¥i cung c·∫•p c√°c s·∫£n ph·∫©m ƒëi·ªán tho·∫°i, ƒëa d·∫°ng h√£ng. V√≠ d·ª•: IPhone,SamSung,Nokia...";
					if (msg.match(/(iphone)/)) return "C√°c s·∫£n ph·∫©m iphone hi·ªán nay. Iphone 13,Iphone 14, Iphone 15...";
					if (msg.match(/(gi√°|gia|bao gia|gia san pham)/)) return "B·∫°n vui l√≤ng n√≥i r√µ s·∫£n ph·∫©m ƒë·ªÉ t√¥i b√°o gi√° nh√©!";
					if (msg.match(/(li√™n h·ªá|lien he|cach lien he|)/)) return "G·ªçi 1800-123-456 ho·∫∑c nh·∫Øn tin t·∫°i ƒë√¢y nh√©.";
					if (msg.match(/(bye|chao|tam biet|hen gap lai||H·∫πn g·∫∑p l·∫°i b·∫°n!|)/)) return "H·∫πn g·∫∑p l·∫°i b·∫°n!";
					return "T√¥i ch∆∞a hi·ªÉu r√µ. B·∫°n c√≥ th·ªÉ h·ªèi l·∫°i c·ª• th·ªÉ h∆°n kh√¥ng?";
				}

			</script>
			{% if request.path == '/' %}
			<!-- üéâ Popup Khuy·∫øn M√£i -->
			<!-- üéâ Popup Khuy·∫øn M√£i C√≥ H√¨nh -->
			<style>
				#promo-popup {
					display: none;
					position: fixed;
					top: 0;
					left: 0;
					width: 100vw;
					height: 100vh;
					background: rgba(0, 0, 0, 0.5);
					z-index: 10000;
					justify-content: center;
					align-items: center;
				}

				#promo-content {
					background: white;
					padding: 20px;
					border-radius: 16px;
					max-width: 400px;
					text-align: center;
					box-shadow: 0 8px 20px rgba(0, 0, 0, 0.3);
					position: relative;
					animation: popupFadeIn 0.5s ease;
				}

				#promo-content img {
					width: 100%;
					border-radius: 12px;
					margin-bottom: 16px;
				}

				#promo-content h2 {
					color: #d60000;
					margin: 10px 0;
				}

				#promo-content p {
					font-size: 16px;
					color: #333;
				}

				#promo-close {
					position: absolute;
					top: 10px;
					right: 14px;
					background: none;
					border: none;
					font-size: 22px;
					color: #999;
					cursor: pointer;
				}

				@keyframes popupFadeIn {
					from {
						transform: scale(0.9);
						opacity: 0;
					}

					to {
						transform: scale(1);
						opacity: 1;
					}
				}
			</style>

			<div id="promo-popup">
				<div id="promo-content">
					<button id="promo-close" onclick="closePromo()">‚ùå</button>
					<!-- üñºÔ∏è H√¨nh ·∫£nh khuy·∫øn m√£i -->

					<h2>üéÅ ∆Øu ƒê√£i ƒê·∫∑c Bi·ªát!</h2>
					<p>Gi·∫£m gi√° ƒë·∫øn <strong>7%</strong> t·∫•t c·∫£ s·∫£n ph·∫©m trong tu·∫ßn n√†y!</p>
					<p>Ch·ªâ √°p d·ª•ng ƒë·∫øn <strong>20/5</strong>. Nhanh tay nh√©!</p>
				</div>
			</div>

			<script>
				function showPromo() {
					document.getElementById("promo-popup").style.display = "flex";
				}
				function closePromo() {
					document.getElementById("promo-popup").style.display = "none";
				}
				window.addEventListener("load", () => {
					setTimeout(showPromo, 1000); // sau 1s hi·ªán popup
				});
			</script>
			{% endif %}


		</footer><!--/Footer-->

		<script src="{% static 'js/jquery.js' %}"></script>
		<script src="{% static 'js/bootstrap.min.js' %}"></script>
		<script src="{% static 'js/jquery.scrollUp.min.js' %}"></script>
		<script src="{% static 'js/price-range.js' %}"></script>
		<script src="{% static 'js/jquery.prettyPhoto.js' %}"></script>
		<script src="{% static 'js/main.js' %}"></script>

		<script>
			$(document).ready(function () {
				$(".add-to-cart").each(function () {
					$(this).click(function () {
						let url = $(this).data('href');
						if ($(this).data('logged-user') === "True") {
							$.ajax({
								type: "GET",
								url: url,
								success: function (data) {
									$("sup.badge").text(data.quantity);
									$("#alert-add-product").show();
									setTimeout(function () {
										$("#alert-add-product").hide();
									}, 1000);
								},
								error: function (xhr, textStatus, errorThrow) {
									console.log(errorThrow);
								}
							})
						}
						else {
							window.location.href = url;
						}
					});
				});
			});
		</script>

	</div>
</body>

</html>